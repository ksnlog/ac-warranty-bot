<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AC Warranty Extension with Enhanced File Upload</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0062cc 0%, #00a1ff 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 900px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #0062cc, #0096ff);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        header p {
            font-size: 18px;
            opacity: 0.9;
        }
        
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 500px;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f9f9f9;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message {
            max-width: 80%;
            padding: 12px 18px;
            border-radius: 18px;
            animation: fadeIn 0.3s ease-in;
            line-height: 1.5;
        }
        
        .bot-message {
            background: #e6f2ff;
            color: #0062cc;
            border-bottom-left-radius: 5px;
            align-self: flex-start;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .user-message {
            background: #0062cc;
            color: white;
            border-bottom-right-radius: 5px;
            align-self: flex-end;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .option-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }
        
        .option-btn {
            background: white;
            color: #0062cc;
            border: 2px solid #0062cc;
            border-radius: 25px;
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .option-btn:hover {
            background: #0062cc;
            color: white;
        }
        
        .option-btn .price {
            font-weight: bold;
            background: #e6f2ff;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 14px;
        }
        
        .option-btn:hover .price {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .input-section {
            display: flex;
            padding: 15px;
            background: white;
            border-top: 1px solid #eee;
            gap: 10px;
        }
        
        #user-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        #user-input:focus {
            border-color: #0062cc;
            box-shadow: 0 0 0 2px rgba(0, 98, 204, 0.2);
        }
        
        button {
            background: #0062cc;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 20px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background: #004a99;
        }
        
        .coverage-section, .details-section, .confirmation-section {
            background: white;
            padding: 25px;
            border-top: 1px solid #eee;
            display: none;
        }
        
        .section-title {
            color: #0062cc;
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .coverage-details {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .covered, .not-covered {
            flex: 1;
            min-width: 250px;
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .covered h4, .not-covered h4 {
            color: #0062cc;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .covered h4 {
            color: #2ecc71;
        }
        
        .not-covered h4 {
            color: #e74c3c;
        }
        
        ul {
            list-style-type: none;
            padding-left: 5px;
        }
        
        li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
        }
        
        .covered li:before {
            content: "✓";
            color: #2ecc71;
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        .not-covered li:before {
            content: "✗";
            color: #e74c3c;
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #444;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            border-color: #0062cc;
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 98, 204, 0.2);
        }
        
        .upload-group {
            margin-bottom: 25px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }
        
        .upload-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: #444;
        }
        
        .upload-group p {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .file-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .file-input input[type="file"] {
            flex: 1;
            padding: 10px;
            border: 1px dashed #0062cc;
            border-radius: 8px;
            background: #e6f2ff;
        }
        
        .file-types {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        .extracted-data {
            margin-top: 15px;
            padding: 15px;
            background: #e6f2ff;
            border-radius: 8px;
            display: none;
        }
        
        .extracted-data h5 {
            margin-bottom: 10px;
            color: #0062cc;
        }
        
        .extracted-data div {
            margin-bottom: 8px;
            display: flex;
        }
        
        .extracted-data .data-label {
            font-weight: 500;
            min-width: 120px;
        }
        
        .confirmation-details {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .confirmation-item {
            margin-bottom: 15px;
            display: flex;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        
        .confirmation-label {
            font-weight: bold;
            min-width: 200px;
            color: #555;
        }
        
        .confirmation-value {
            color: #0062cc;
            font-weight: 500;
        }
        
        .payment-section {
            background: white;
            padding: 25px;
            border-top: 1px solid #eee;
            display: none;
        }
        
        .payment-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .payment-option {
            flex: 1;
            min-width: 200px;
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .payment-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .payment-option.selected {
            border-color: #0062cc;
            background: #e6f2ff;
        }
        
        .payment-option i {
            font-size: 40px;
            margin-bottom: 10px;
            color: #0062cc;
        }
        
        .payment-option h4 {
            color: #0062cc;
            margin-bottom: 10px;
        }
        
        .payment-details {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
        }
        
        .payment-info {
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
        }
        
        .payment-label {
            font-weight: bold;
            color: #555;
        }
        
        .payment-value {
            color: #0062cc;
            font-weight: 500;
        }
        
        .upi-id {
            font-size: 22px;
            font-weight: bold;
            color: #0062cc;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 2px dashed #0062cc;
        }
        
        .qr-code {
            width: 200px;
            height: 200px;
            margin: 15px auto;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }
        
        .qr-code i {
            font-size: 80px;
            color: #0062cc;
        }
        
        .payment-instructions {
            margin-top: 20px;
            padding: 15px;
            background: #e6f2ff;
            border-radius: 8px;
        }
        
        .payment-instructions ol {
            text-align: left;
            padding-left: 20px;
        }
        
        .payment-instructions li {
            margin-bottom: 10px;
        }
        
        .payment-status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        
        .payment-status.success {
            background: #d4edda;
            color: #155724;
            display: block;
        }
        
        .payment-status.processing {
            background: #fff3cd;
            color: #856404;
            display: block;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-top: 15px;
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .error-message {
            color: #dc3545;
            font-size: 14px;
            margin-top: 5px;
            padding: 0 15px;
            display: none;
        }
        
        .typing-indicator {
            display: inline-block;
            padding: 12px 18px;
            background: #e6f2ff;
            border-radius: 18px;
            color: #0062cc;
        }
        
        .typing-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #0062cc;
            margin: 0 3px;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        
        .progress-bar {
            height: 6px;
            background: #ddd;
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
            display: none;
        }
        
        .progress {
            height: 100%;
            background: #0062cc;
            width: 0%;
            transition: width 0.3s;
        }
        
        .status-message {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
            display: none;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
           30% { transform: translateY(-5px); }
        }
        
        @media (max-width: 600px) {
            header h1 {
                font-size: 22px;
            }
            
            header p {
                font-size: 16px;
            }
            
            .chat-messages {
                padding: 15px;
            }
            
            .message {
                max-width: 90%;
            }
            
            .option-btn {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .input-section {
                flex-direction: column;
            }
            
            button {
                margin-top: 10px;
                justify-content: center;
            }
            
            .coverage-details {
                flex-direction: column;
            }
            
            .confirmation-item, .payment-info {
                flex-direction: column;
                gap: 5px;
            }
            
            .confirmation-label, .payment-label {
                min-width: unset;
            }
            
            .file-input {
                flex-direction: column;
            }
            
            .payment-options {
                flex-direction: column;
            }
            
            .upi-id {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-tools"></i> AC Extended Warranty Support</h1>
            <p>Extend warranty for your AC (up to 2 Ton)</p>
        </header>

        <div class="chat-container">
            <div class="chat-messages" id="chat-messages">
                <div class="message bot-message">
                    <i class="fas fa-robot"></i> Hello! Welcome to AC Extended Warranty Support. I'm here to help you extend your AC warranty.
                </div>
                <div class="message bot-message">
                    <i class="fas fa-robot"></i> How old is your AC unit?
                    <div class="option-buttons">
                        <button class="option-btn" onclick="selectAge('Less than 1 year')">
                            <span>Less than 1 year</span>
                        </button>
                        <button class="option-btn" onclick="selectAge('Less than 2 years')">
                            <span>Less than 2 years</span>
                        </button>
                        <button class="option-btn" onclick="selectAge('Less than 4 years')">
                            <span>Less than 4 years</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="input-section">
                <input type="text" id="user-input" placeholder="Type your answer here..." onkeypress="handleKeyPress(event)">
                <button onclick="processInput()"><i class="fas fa-paper-plane"></i> Send</button>
            </div>
            <div id="input-error" class="error-message"></div>
        </div>

        <div class="coverage-section" id="coverage-section">
            <h3 class="section-title"><i class="fas fa-file-contract"></i> Warranty Coverage Details</h3>
            <div class="coverage-details">
                <div class="covered">
                    <h4><i class="fas fa-check-circle"></i> What's Covered</h4>
                    <ul>
                        <li>Compressor, PCBs, Fan Motor, Blower Motor</li>
                        <li>Condenser Coil, Evaporator Coil & other critical parts</li>
                        <li>Refrigerant Gas Leak</li>
                        <li>Labour Charges for All Repairs</li>
                        <li>2 Free Maintenance Service Annually</li>
                    </ul>
                </div>
                <div class="not-covered">
                    <h4><i class="fas fa-times-circle"></i> What's Not Covered</h4>
                    <ul>
                        <li>Damage from accidents or natural disasters</li>
                        <li>Improper installation or usage</li>
                        <li>Cosmetic damage to outer casing</li>
                        <li>Filter replacements (consumable item)</li>
                        <li>Damage from power fluctuations without stabilizer</li>
                        <li>Pre-existing conditions before warranty</li>
                    </ul>
                </div>
            </div>
            <button onclick="proceedToDetails()"><i class="fas fa-arrow-right"></i> Proceed to Purchase</button>
        </div>

        <div class="details-section" id="details-section">
            <h3 class="section-title"><i class="fas fa-user-circle"></i> Customer Details</h3>
            
            <div class="form-group">
                <label for="full-name">Full Name</label>
                <input type="text" id="full-name" placeholder="Enter your full name">
            </div>
            
            <div class="form-group">
                <label for="phone">Registered Phone Number</label>
                <input type="tel" id="phone" placeholder="Enter your 10-digit phone number">
            </div>
            
            <div class="form-group">
                <label for="address">Address with Pincode</label>
                <input type="text" id="address" placeholder="Enter your complete address with pincode">
            </div>
            
            <div class="upload-group">
                <label for="invoice-upload"><i class="fas fa-file-invoice"></i> Upload Invoice Copy / Purchase Proof</label>
                <p>Please upload a clear photo or scan of your purchase invoice</p>
                <div class="file-input">
                    <input type="file" id="invoice-upload" accept=".pdf,.jpg,.jpeg,.png" onchange="handleInvoiceUpload()">
                </div>
                <div class="file-types">Supported formats: PDF, JPG, JPEG, PNG</div>
                <div class="progress-bar" id="invoice-progress">
                    <div class="progress" id="invoice-progress-bar"></div>
                </div>
                <div class="status-message" id="invoice-status">Processing...</div>
                <div class="extracted-data" id="invoice-data">
                    <h5>Extracted Invoice Data</h5>
                    <div>
                        <span class="data-label">Date of Invoice:</span>
                        <span id="invoice-date">Extracting...</span>
                    </div>
                    <div id="invoice-full-text" style="display: none; margin-top: 10px;">
                        <span class="data-label">Full Text:</span>
                        <div style="max-height: 100px; overflow-y: auto; background: white; padding: 10px; border-radius: 5px; font-size: 12px; margin-top: 5px;" id="invoice-text-content"></div>
                    </div>
                </div>
            </div>
            
            <div class="upload-group">
                <label for="indoor-upload"><i class="fas fa-image"></i> Upload Indoor Serial Number Sticker Photo</label>
                <p>Please see the side sticker of indoor unit and upload a clear photo</p>
                <div class="file-input">
                    <input type="file" id="indoor-upload" accept=".pdf,.jpg,.jpeg,.png" onchange="handleIndoorUpload()">
                </div>
                <div class="file-types">Supported formats: PDF, JPG, JPEG, PNG</div>
                <div class="progress-bar" id="indoor-progress">
                    <div class="progress" id="indoor-progress-bar"></div>
                </div>
                <div class="status-message" id="indoor-status">Processing...</div>
                <div class="extracted-data" id="indoor-data">
                    <h5>Extracted Indoor Unit Data</h5>
                    <div>
                        <span class="data-label">Model:</span>
                        <span id="indoor-model">Extracting...</span>
                    </div>
                    <div>
                        <span class="data-label">Serial Number:</span>
                        <span id="indoor-serial">Extracting...</span>
                    </div>
                    <div id="indoor-full-text" style="display: none; margin-top: 10px;">
                        <span class="data-label">Full Text:</span>
                        <div style="max-height: 100px; overflow-y: auto; background: white; padding: 10px; border-radius: 5px; font-size: 12px; margin-top: 5px;" id="indoor-text-content"></div>
                    </div>
                </div>
            </div>
            
            <div class="upload-group">
                <label for="outdoor-upload"><i class="fas fa-image"></i> Upload Outdoor Serial Number Sticker Photo</label>
                <p>Please see the side sticker of outdoor unit and upload a clear photo</p>
                <div class="file-input">
                    <input type="file" id="outdoor-upload" accept=".pdf,.jpg,.jpeg,.png" onchange="handleOutdoorUpload()">
                </div>
                <div class="file-types">Supported formats: PDF, JPG, JPEG, PNG</div>
                <div class="progress-bar" id="outdoor-progress">
                    <div class="progress" id="outdoor-progress-bar"></div>
                </div>
                <div class="status-message" id="outdoor-status">Processing...</div>
                <div class="extracted-data" id="outdoor-data">
                    <h5>Extracted Outdoor Unit Data</h5>
                    <div>
                        <span class="data-label">Model:</span>
                        <span id="outdoor-model">Extracting...</span>
                    </div>
                    <div>
                        <span class="data-label">Serial Number:</span>
                        <span id="outdoor-serial">Extracting...</span>
                    </div>
                    <div id="outdoor-full-text" style="display: none; margin-top: 10px;">
                        <span class="data-label">Full Text:</span>
                        <div style="max-height: 100px; overflow-y: auto; background: white; padding: 10px; border-radius: 5px; font-size: 12px; margin-top: 5px;" id="outdoor-text-content"></div>
                    </div>
                </div>
            </div>
            
            <button onclick="showConfirmation()"><i class="fas fa-check-circle"></i> Submit Details</button>
        </div>

        <div class="confirmation-section" id="confirmation-section">
            <h3 class="section-title"><i class="fas fa-clipboard-check"></i> Please Confirm Your Details</h3>
            
            <div class="confirmation-details">
                <div class="confirmation-item">
                    <span class="confirmation-label">Customer Name:</span>
                    <span class="confirmation-value" id="confirm-name">John Doe</span>
                </div>
                <div class="confirmation-item">
                    <span class="confirmation-label">Phone Number:</span>
                    <span class="confirmation-value" id="confirm-phone">9876543210</span>
                </div>
                <div class="confirmation-item">
                    <span class="confirmation-label">Indoor Model & Serial Number:</span>
                    <span class="confirmation-value" id="confirm-indoor">ABC-123XYZ / IN123456789</span>
                </div>
                <div class="confirmation-item">
                    <span class="confirmation-label">Outdoor Model & Serial Number:</span>
                    <span class="confirmation-value" id="confirm-outdoor">DEF-456UVW / OUT987654321</span>
                </div>
                <div class="confirmation-item">
                    <span class="confirmation-label">Date of Purchase:</span>
                    <span class="confirmation-value" id="confirm-date">15-05-2022</span>
                </div>
                <div class="confirmation-item">
                    <span class="confirmation-label">Extended Warranty:</span>
                    <span class="confirmation-value" id="confirm-warranty">2 years</span>
                </div>
                <div class="confirmation-item">
                    <span class="confirmation-label">Price:</span>
                    <span class="confirmation-value" id="confirm-price">₹2499</span>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px;">
                <button onclick="editDetails()"><i class="fas fa-edit"></i> Edit Details</button>
                <button onclick="proceedToPayment()" style="background: #2ecc71;"><i class="fas fa-credit-card"></i> Proceed to Payment</button>
            </div>
        </div>

        <div class="payment-section" id="payment-section">
            <h3 class="section-title"><i class="fas fa-credit-card"></i> Payment Options</h3>
            
            <div class="payment-options">
                <div class="payment-option selected" id="upi-option" onclick="selectPaymentOption('upi')">
                    <i class="fas fa-mobile-alt"></i>
                    <h4>UPI Payment</h4>
                    <p>Pay using any UPI app</p>
                </div>
                <div class="payment-option" id="phonepay-option" onclick="selectPaymentOption('phonepay')">
                    <i class="fas fa-money-bill-wave"></i>
                    <h4>PhonePe</h4>
                    <p>Pay using PhonePe app</p>
                </div>
                <div class="payment-option" id="googlepay-option" onclick="selectPaymentOption('googlepay')">
                    <i class="fab fa-google"></i>
                    <h4>Google Pay</h4>
                    <p>Pay using Google Pay app</p>
                </div>
            </div>
            
            <div class="payment-details">
                <div class="payment-info">
                    <span class="payment-label">Warranty Period:</span>
                    <span class="payment-value" id="warranty-period">2 years</span>
                </div>
                <div class="payment-info">
                    <span class="payment-label">Amount to Pay:</span>
                    <span class="payment-value" id="payment-amount">₹2499</span>
                </div>
                
                <div class="upi-id" id="upi-id-display">coolcare@ybl</div>
                
                <div class="qr-code">
                    <i class="fas fa-qrcode"></i>
                </div>
                
                <div class="payment-instructions">
                    <h4><i class="fas fa-info-circle"></i> Payment Instructions</h4>
                    <ol>
                        <li>Open your UPI app (PhonePe, Google Pay, Paytm, etc.)</li>
                        <li>Send payment to the UPI ID shown above</li>
                        <li>Enter the exact amount: <strong>₹2499</strong></li>
                        <li>Add your name in the备注/notes field</li>
                        <li>Complete the payment</li>
                    </ol>
                </div>
                
                <div class="payment-status processing" id="payment-status">
                    <i class="fas fa-sync-alt fa-spin"></i> Waiting for payment confirmation...
                </div>
                
                <div style="margin-top: 20px;">
                    <button onclick="checkPaymentStatus()"><i class="fas fa-sync-alt"></i> Check Payment Status</button>
                    <button onclick="simulatePayment()" style="background: #2ecc71; margin-left: 10px;"><i class="fas fa-check"></i> I've Made the Payment</button>
                </div>
            </div>
            
            <div id="payment-success" class="success-message">
                <i class="fas fa-check-circle"></i> Payment verified successfully! Your warranty has been extended. You will receive a confirmation email shortly.
            </div>
        </div>
    </div>

    <script>
        // Set up PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';
        
        // Conversation state management
        const conversationState = {
            step: 'ageSelection',
            acAge: null,
            warrantySelection: null,
            customerName: null,
            customerPhone: null,
            customerAddress: null,
            invoiceDate: null,
            indoorModel: null,
            indoorSerial: null,
            outdoorModel: null,
            outdoorSerial: null,
            paymentMethod: 'upi'
        };
        
        // DOM elements
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const inputError = document.getElementById('input-error');
        const coverageSection = document.getElementById('coverage-section');
        const detailsSection = document.getElementById('details-section');
        const confirmationSection = document.getElementById('confirmation-section');
        const paymentSection = document.getElementById('payment-section');
        const warrantyPeriod = document.getElementById('warranty-period');
        const paymentAmount = document.getElementById('payment-amount');
        const paymentSuccess = document.getElementById('payment-success');
        const paymentStatus = document.getElementById('payment-status');
        
        // Handle Enter key press
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                processInput();
            }
        }
        
        // Add message to chat
        function addMessage(text, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            
            const icon = isUser ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>';
            messageDiv.innerHTML = `${icon} ${text}`;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Show typing indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = '<i class="fas fa-robot"></i> <span class="typing-dot"></span><span class="typing-dot"></span><span class="typing-dot"></span>';
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Hide typing indicator
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        // Show error message
        function showError(message) {
            inputError.textContent = message;
            inputError.style.display = 'block';
        }
        
        // Hide error message
        function hideError() {
            inputError.style.display = 'none';
        }
        
        // Validate phone number (Indian format)
        function isValidPhone(phone) {
            const regex = /^[6-9]\d{9}$/;
            return regex.test(phone);
        }
        
        // Select AC age
        function selectAge(age) {
            conversationState.acAge = age;
            addMessage(age, true);
            
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                
                let optionsHtml = '';
                
                if (age === 'Less than 1 year') {
                    optionsHtml = `
                        <div class="option-buttons">
                            <button class="option-btn" onclick="selectWarranty('4 years', 3999)">
                                <span>Extend warranty for 4 years</span>
                                <span class="price">₹3999</span>
                            </button>
                            <button class="option-btn" onclick="selectWarranty('2 years', 2499)">
                                <span>Extend warranty for 2 years</span>
                                <span class="price">₹2499</span>
                            </button>
                            <button class="option-btn" onclick="selectWarranty('1 year', 1499)">
                                <span>Extend warranty for 1 year</span>
                                <span class="price">₹1499</span>
                            </button>
                        </div>
                    `;
                } else if (age === 'Less than 2 years') {
                    optionsHtml = `
                        <div class="option-buttons">
                            <button class="option-btn" onclick="selectWarranty('2 years', 2999)">
                                <span>Extend warranty for 2 years</span>
                                <span class="price">₹2999</span>
                            </button>
                            <button class="option-btn" onclick="selectWarranty('1 year', 1999)">
                                <span>Extend warranty for 1 year</span>
                                <span class="price">₹1999</span>
                            </button>
                        </div>
                    `;
                } else if (age === 'Less than 4 years') {
                    optionsHtml = `
                        <div class="option-buttons">
                            <button class="option-btn" onclick="selectWarranty('1 year', 2499)">
                                <span>Extend warranty for 1 year</span>
                                <span class="price">₹2499</span>
                            </button>
                        </div>
                    `;
                }
                
                addMessage(`Based on your AC's age, here are your warranty extension options:`);
                
                // Add options to the last bot message
                const botMessages = document.querySelectorAll('.bot-message');
                const lastBotMessage = botMessages[botMessages.length - 1];
                lastBotMessage.innerHTML += optionsHtml;
                
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1000);
        }
        
        // Select warranty option
        function selectWarranty(period, price) {
            conversationState.warrantySelection = { period, price };
            addMessage(`Extend warranty for ${period} (₹${price})`, true);
            
            // Show coverage section
            coverageSection.style.display = 'block';
            
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                addMessage('Please review what\'s covered and what\'s not covered in your warranty extension. Then proceed to purchase.');
                
                // Scroll to coverage section
                setTimeout(() => {
                    coverageSection.scrollIntoView({ behavior: 'smooth' });
                }, 500);
            }, 1000);
        }
        
        // Proceed to details collection after reviewing coverage
        function proceedToDetails() {
            coverageSection.style.display = 'none';
            detailsSection.style.display = 'block';
            
            // Scroll to details section
            setTimeout(() => {
                detailsSection.scrollIntoView({ behavior: 'smooth' });
            }, 500);
        }
        
        // Enhanced date extraction function
        function extractDateFromText(text) {
            // Try multiple date patterns
            const datePatterns = [
                /\b(\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{4})\b/, // DD-MM-YYYY or DD/MM/YYYY
                /\b(\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{2})\b/, // DD-MM-YY or DD/MM/YY
                /\b(\d{1,2}\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{4})\b/i, // DD MMM YYYY
                /\b(\d{1,2}\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{2})\b/i, // DD MMM YY
                /\b((Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{1,2},?\s+\d{4})\b/i, // MMM DD, YYYY
            ];
            
            for (const pattern of datePatterns) {
                const matches = text.match(pattern);
                if (matches && matches.length > 0) {
                    return matches[0];
                }
            }
            
            return null;
        }
        
        // Enhanced model extraction function
        function extractModelFromText(text) {
            // Look for models starting with ASGG or AOGG
            const modelPatterns = [
                /\b(ASGG[-\s]?[A-Za-z0-9]{3,})\b/i,
                /\b(AOGG[-\s]?[A-Za-z0-9]{3,})\b/i
            ];
            
            for (const pattern of modelPatterns) {
                const matches = text.match(pattern);
                if (matches && matches.length > 0) {
                    return matches[0];
                }
            }
            
            return null;
        }
        
        // Enhanced serial number extraction function
        function extractSerialFromText(text) {
            // Look for serial numbers starting with a letter followed by 7 digits
            const serialPattern = /\b([A-Za-z][A-Za-z0-9]{6,8})\b/;
            
            const matches = text.match(serialPattern);
            if (matches && matches.length > 0) {
                // Check if it looks like a serial number (not a word, not a date, etc.)
                const potentialSerial = matches[0];
                if (!potentialSerial.match(/\d{4}/) && // Not a year
                    !potentialSerial.match(/^[A-Za-z]{4,}$/) && // Not just letters
                    potentialSerial.length >= 7 && potentialSerial.length <= 10) {
                    return potentialSerial;
                }
            }
            
            return null;
        }
        
        // Convert PDF to image for OCR processing
        async function convertPdfToImage(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = async function(event) {
                    try {
                        const typedarray = new Uint8Array(event.target.result);
                        const pdf = await pdfjsLib.getDocument(typedarray).promise;
                        const page = await pdf.getPage(1);
                        const viewport = page.getViewport({ scale: 1.5 });
                        
                        const canvas = document.createElement('canvas');
                        const context = canvas.getContext('2d');
                        canvas.height = viewport.height;
                        canvas.width = viewport.width;
                        
                        await page.render({
                            canvasContext: context,
                            viewport: viewport
                        }).promise;
                        
                        resolve(canvas.toDataURL('image/jpeg'));
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.readAsArrayBuffer(file);
            });
        }
        
        // Process file for OCR based on its type
        async function processFileForOCR(file, statusElement, progressBar, progressBarInner) {
            if (file.type === 'application/pdf') {
                statusElement.textContent = 'Converting PDF to image...';
                try {
                    const imageData = await convertPdfToImage(file);
                    statusElement.textContent = 'PDF converted. Processing text...';
                    return imageData;
                } catch (error) {
                    statusElement.textContent = 'Error converting PDF: ' + error.message;
                    statusElement.style.color = '#e74c3c';
                    throw error;
                }
            } else {
                // For image files, create a data URL
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        resolve(e.target.result);
                    };
                    reader.readAsDataURL(file);
                });
            }
        }
        
        // Handle invoice upload and OCR processing
        async function handleInvoiceUpload() {
            const fileInput = document.getElementById('invoice-upload');
            if (!fileInput.files.length) return;
            
            const file = fileInput.files[0];
            const statusElement = document.getElementById('invoice-status');
            const progressBar = document.getElementById('invoice-progress');
            const progressBarInner = document.getElementById('invoice-progress-bar');
            const extractedData = document.getElementById('invoice-data');
            const invoiceDate = document.getElementById('invoice-date');
            const invoiceText = document.getElementById('invoice-text-content');
            const invoiceFullText = document.getElementById('invoice-full-text');
            
            // Show progress UI
            progressBar.style.display = 'block';
            statusElement.style.display = 'block';
            statusElement.textContent = 'Processing file...';
            extractedData.style.display = 'block';
            invoiceDate.textContent = 'Extracting date...';
            
            try {
                // Process file based on type (PDF or image)
                const imageData = await processFileForOCR(file, statusElement, progressBar, progressBarInner);
                
                // Perform OCR using Tesseract.js
                const result = await Tesseract.recognize(
                    imageData,
                    'eng',
                    { 
                        logger: progress => {
                            if (progress.status === 'recognizing text') {
                                progressBarInner.style.width = `${progress.progress * 100}%`;
                                
                                if (progress.progress === 1) {
                                    statusElement.textContent = 'Almost done...';
                                }
                            }
                        }
                    }
                );
                
                const text = result.data.text;
                invoiceText.textContent = text;
                invoiceFullText.style.display = 'block';
                
                // Try to find a date in the text using enhanced extraction
                const extractedDate = extractDateFromText(text);
                
                if (extractedDate) {
                    conversationState.invoiceDate = extractedDate;
                    invoiceDate.textContent = extractedDate;
                    statusElement.textContent = 'Date extracted successfully!';
                    statusElement.style.color = '#2ecc71';
                } else {
                    invoiceDate.textContent = 'No date found. Please enter manually:';
                    statusElement.textContent = 'Could not find date. Please enter manually.';
                    statusElement.style.color = '#e74c3c';
                    
                    // Create input for manual date entry
                    const manualInput = document.createElement('input');
                    manualInput.type = 'text';
                    manualInput.placeholder = 'DD-MM-YYYY';
                    manualInput.style.marginLeft = '10px';
                    manualInput.style.padding = '5px';
                    manualInput.style.border = '1px solid #ddd';
                    manualInput.style.borderRadius = '4px';
                    
                    manualInput.onchange = function() {
                        conversationState.invoiceDate = this.value;
                        invoiceDate.textContent = this.value;
                        this.style.display = 'none';
                    };
                    
                    invoiceDate.appendChild(manualInput);
                }
                
            } catch (err) {
                statusElement.textContent = 'Error processing file: ' + err.message;
                statusElement.style.color = '#e74c3c';
            } finally {
                progressBar.style.display = 'none';
            }
        }
        
        // Handle indoor unit upload and OCR processing
        async function handleIndoorUpload() {
            const fileInput = document.getElementById('indoor-upload');
            if (!fileInput.files.length) return;
            
            const file = fileInput.files[0];
            const statusElement = document.getElementById('indoor-status');
            const progressBar = document.getElementById('indoor-progress');
            const progressBarInner = document.getElementById('indoor-progress-bar');
            const extractedData = document.getElementById('indoor-data');
            const indoorModel = document.getElementById('indoor-model');
            const indoorSerial = document.getElementById('indoor-serial');
            const indoorText = document.getElementById('indoor-text-content');
            const indoorFullText = document.getElementById('indoor-full-text');
            
            // Show progress UI
            progressBar.style.display = 'block';
            statusElement.style.display = 'block';
            statusElement.textContent = 'Processing file...';
            extractedData.style.display = 'block';
            indoorModel.textContent = 'Extracting model...';
            indoorSerial.textContent = 'Extracting serial number...';
            
            try {
                // Process file based on type (PDF or image)
                const imageData = await processFileForOCR(file, statusElement, progressBar, progressBarInner);
                
                // Perform OCR using Tesseract.js
                const result = await Tesseract.recognize(
                    imageData,
                    'eng',
                    { 
                        logger: progress => {
                            if (progress.status === 'recognizing text') {
                                progressBarInner.style.width = `${progress.progress * 100}%`;
                                
                                if (progress.progress === 1) {
                                    statusElement.textContent = 'Almost done...';
                                }
                            }
                        }
                    }
                );
                
                const text = result.data.text;
                indoorText.textContent = text;
                indoorFullText.style.display = 'block';
                
                // Try to find model and serial numbers using enhanced extraction
                const extractedModel = extractModelFromText(text);
                const extractedSerial = extractSerialFromText(text);
                
                if (extractedModel) {
                    conversationState.indoorModel = extractedModel;
                    indoorModel.textContent = extractedModel;
                } else {
                    indoorModel.textContent = 'Model not found. Please enter manually:';
                    
                    const manualInput = document.createElement('input');
                    manualInput.type = 'text';
                    manualInput.placeholder = 'Indoor model (ASGG... or AOGG...)';
                    manualInput.style.marginLeft = '10px';
                    manualInput.style.padding = '5px';
                    manualInput.style.border = '1px solid #ddd';
                    manualInput.style.borderRadius = '4px';
                    
                    manualInput.onchange = function() {
                        conversationState.indoorModel = this.value;
                        indoorModel.textContent = this.value;
                        this.style.display = 'none';
                    };
                    
                    indoorModel.appendChild(manualInput);
                }
                
                if (extractedSerial) {
                    conversationState.indoorSerial = extractedSerial;
                    indoorSerial.textContent = extractedSerial;
                } else {
                    indoorSerial.textContent = 'Serial not found. Please enter manually:';
                    
                    const manualInput = document.createElement('input');
                    manualInput.type = 'text';
                    manualInput.placeholder = 'Indoor serial (starts with letter)';
                    manualInput.style.marginLeft = '10px';
                    manualInput.style.padding = '5px';
                    manualInput.style.border = '1px solid #ddd';
                    manualInput.style.borderRadius = '4px';
                    
                    manualInput.onchange = function() {
                        conversationState.indoorSerial = this.value;
                        indoorSerial.textContent = this.value;
                        this.style.display = 'none';
                    };
                    
                    indoorSerial.appendChild(manualInput);
                }
                
                if (extractedModel && extractedSerial) {
                    statusElement.textContent = 'Data extracted successfully!';
                    statusElement.style.color = '#2ecc71';
                } else {
                    statusElement.textContent = 'Some data not found. Please check manually.';
                    statusElement.style.color = '#e74c3c';
                }
                
            } catch (err) {
                statusElement.textContent = 'Error processing file: ' + err.message;
                statusElement.style.color = '#e74c3c';
            } finally {
                progressBar.style.display = 'none';
            }
        }
        
        // Handle outdoor unit upload and OCR processing
        async function handleOutdoorUpload() {
            const fileInput = document.getElementById('outdoor-upload');
            if (!fileInput.files.length) return;
            
            const file = fileInput.files[0];
            const statusElement = document.getElementById('outdoor-status');
            const progressBar = document.getElementById('outdoor-progress');
            const progressBarInner = document.getElementById('outdoor-progress-bar');
            const extractedData = document.getElementById('outdoor-data');
            const outdoorModel = document.getElementById('outdoor-model');
            const outdoorSerial = document.getElementById('outdoor-serial');
            const outdoorText = document.getElementById('outdoor-text-content');
            const outdoorFullText = document.getElementById('outdoor-full-text');
            
            // Show progress UI
            progressBar.style.display = 'block';
            statusElement.style.display = 'block';
            statusElement.textContent = 'Processing file...';
            extractedData.style.display = 'block';
            outdoorModel.textContent = 'Extracting model...';
            outdoorSerial.textContent = 'Extracting serial number...';
            
            try {
                // Process file based on type (PDF or image)
                const imageData = await processFileForOCR(file, statusElement, progressBar, progressBarInner);
                
                // Perform OCR using Tesseract.js
                const result = await Tesseract.recognize(
                    imageData,
                    'eng',
                    { 
                        logger: progress => {
                            if (progress.status === 'recognizing text') {
                                progressBarInner.style.width = `${progress.progress * 100}%`;
                                
                                if (progress.progress === 1) {
                                    statusElement.textContent = 'Almost done...';
                                }
                            }
                        }
                    }
                );
                
                const text = result.data.text;
                outdoorText.textContent = text;
                outdoorFullText.style.display = 'block';
                
                // Try to find model and serial numbers using enhanced extraction
                const extractedModel = extractModelFromText(text);
                const extractedSerial = extractSerialFromText(text);
                
                if (extractedModel) {
                    conversationState.outdoorModel = extractedModel;
                    outdoorModel.textContent = extractedModel;
                } else {
                    outdoorModel.textContent = 'Model not found. Please enter manually:';
                    
                    const manualInput = document.createElement('input');
                    manualInput.type = 'text';
                    manualInput.placeholder = 'Outdoor model (ASGG... or AOGG...)';
                    manualInput.style.marginLeft = '10px';
                    manualInput.style.padding = '5px';
                    manualInput.style.border = '1px solid #ddd';
                    manualInput.style.borderRadius = '4px';
                    
                    manualInput.onchange = function() {
                        conversationState.outdoorModel = this.value;
                        outdoorModel.textContent = this.value;
                        this.style.display = 'none';
                    };
                    
                    outdoorModel.appendChild(manualInput);
                }
                
                if (extractedSerial) {
                    conversationState.outdoorSerial = extractedSerial;
                    outdoorSerial.textContent = extractedSerial;
                } else {
                    outdoorSerial.textContent = 'Serial not found. Please enter manually:';
                    
                    const manualInput = document.createElement('input');
                    manualInput.type = 'text';
                    manualInput.placeholder = 'Outdoor serial (starts with letter)';
                    manualInput.style.marginLeft = '10px';
                    manualInput.style.padding = '5px';
                    manualInput.style.border = '1px solid #ddd';
                    manualInput.style.borderRadius = '4px';
                    
                    manualInput.onchange = function() {
                        conversationState.outdoorSerial = this.value;
                        outdoorSerial.textContent = this.value;
                        this.style.display = 'none';
                    };
                    
                    outdoorSerial.appendChild(manualInput);
                }
                
                if (extractedModel && extractedSerial) {
                    statusElement.textContent = 'Data extracted successfully!';
                    statusElement.style.color = '#2ecc71';
                } else {
                    statusElement.textContent = 'Some data not found. Please check manually.';
                    statusElement.style.color = '#e74c3c';
                }
                
            } catch (err) {
                statusElement.textContent = 'Error processing file: ' + err.message;
                statusElement.style.color = '#e74c3c';
            } finally {
                progressBar.style.display = 'none';
            }
        }
        
        // Show confirmation page with all details
        function showConfirmation() {
            // Get values from form
            const fullName = document.getElementById('full-name').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            
            // Validate required fields
            if (!fullName || !phone || !address || !conversationState.invoiceDate || 
                !conversationState.indoorModel || !conversationState.outdoorModel) {
                alert('Please fill all required fields and extract data from all uploaded files');
                return;
            }
            
            // Validate phone number
            if (!isValidPhone(phone)) {
                alert('Please enter a valid 10-digit phone number');
                return;
            }
            
            // Save customer details
            conversationState.customerName = fullName;
            conversationState.customerPhone = phone;
            conversationState.customerAddress = address;
            
            // Update confirmation page
            document.getElementById('confirm-name').textContent = fullName;
            document.getElementById('confirm-phone').textContent = phone;
            document.getElementById('confirm-indoor').textContent = `${conversationState.indoorModel} / ${conversationState.indoorSerial || 'N/A'}`;
            document.getElementById('confirm-outdoor').textContent = `${conversationState.outdoorModel} / ${conversationState.outdoorSerial || 'N/A'}`;
            document.getElementById('confirm-date').textContent = conversationState.invoiceDate;
            document.getElementById('confirm-warranty').textContent = conversationState.warrantySelection.period;
            document.getElementById('confirm-price').textContent = `₹${conversationState.warrantySelection.price}`;
            
            // Show confirmation section
            detailsSection.style.display = 'none';
            confirmationSection.style.display = 'block';
            
            // Scroll to confirmation section
            setTimeout(() => {
                confirmationSection.scrollIntoView({ behavior: 'smooth' });
            }, 500);
        }
        
        // Edit details
        function editDetails() {
            confirmationSection.style.display = 'none';
            detailsSection.style.display = 'block';
            
            // Scroll to details section
            setTimeout(() => {
                detailsSection.scrollIntoView({ behavior: 'smooth' });
            }, 500);
        }
        
        // Select payment option
        function selectPaymentOption(option) {
            conversationState.paymentMethod = option;
            
            // Update UI
            document.getElementById('upi-option').classList.remove('selected');
            document.getElementById('phonepay-option').classList.remove('selected');
            document.getElementById('googlepay-option').classList.remove('selected');
            document.getElementById(option + '-option').classList.add('selected');
            
            // Update UPI ID based on selection
            const upiIdDisplay = document.getElementById('upi-id-display');
            if (option === 'phonepay') {
                upiIdDisplay.textContent = 'coolcare.phonepay@ybl';
            } else if (option === 'googlepay') {
                upiIdDisplay.textContent = 'coolcare.googlepay@oksbi';
            } else {
                upiIdDisplay.textContent = 'coolcare@ybl';
            }
        }
        
        // Proceed to payment after confirmation
        function proceedToPayment() {
            confirmationSection.style.display = 'none';
            
            // Update payment details
            warrantyPeriod.textContent = conversationState.warrantySelection.period;
            paymentAmount.textContent = `₹${conversationState.warrantySelection.price}`;
            
            // Show payment section
            paymentSection.style.display = 'block';
            paymentStatus.style.display = 'block';
            
            addMessage('Thank you! Your details have been confirmed. Please complete the payment using any UPI app.');
            
            // Start checking for payment status
            checkPaymentStatus();
            
            // Scroll to payment section
            setTimeout(() => {
                paymentSection.scrollIntoView({ behavior: 'smooth' });
            }, 500);
        }
        
        // Check payment status (simulated)
        function checkPaymentStatus() {
            paymentStatus.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Checking payment status...';
            paymentStatus.className = 'payment-status processing';
            
            // Simulate API call to check payment status
            setTimeout(() => {
                // For demo purposes, we'll randomly determine if payment was successful
                const isSuccess = Math.random() > 0.5;
                
                if (isSuccess) {
                    paymentStatus.innerHTML = '<i class="fas fa-check-circle"></i> Payment confirmed successfully!';
                    paymentStatus.className = 'payment-status success';
                    paymentSuccess.style.display = 'block';
                    
                    addMessage('Payment verified successfully! Your warranty has been extended. You will receive a confirmation email shortly.');
                } else {
                    paymentStatus.innerHTML = '<i class="fas fa-exclamation-circle"></i> Payment not yet received. Please complete the payment.';
                    paymentStatus.className = 'payment-status processing';
                }
            }, 2000);
        }
        
        // Simulate payment for demo purposes
        function simulatePayment() {
            paymentStatus.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Processing payment...';
            paymentStatus.className = 'payment-status processing';
            
            setTimeout(() => {
                paymentStatus.innerHTML = '<i class="fas fa-check-circle"></i> Payment confirmed successfully!';
                paymentStatus.className = 'payment-status success';
                paymentSuccess.style.display = 'block';
                
                addMessage('Payment verified successfully! Your warranty has been extended. You will receive a confirmation email shortly.');
            }, 1500);
        }
        
        // Focus on input when page loads
        window.onload = function() {
            userInput.focus();
        };
    </script>
</body>
</html>
